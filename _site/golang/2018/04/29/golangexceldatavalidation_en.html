<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="keywords" content="The Golang operation EXCEL  library  for columns and cell  supports data validation  (drop-down list, numeric text length check)">
  <meta name="description" content="">
  <meta name="author" content="Reage">
  <title>
    
      The Golang operation EXCEL  library  for columns and cell  supports data validation  (drop-down list, numeric text length check) &middot; Reage blog
    
  </title>
  <!-- CSS -->
  <link rel="stylesheet" type="text/css" href="/public/css/poole.min.css" />
  <link rel="stylesheet" type="text/css" href="/public/css/lanyon.min.css"/>
  <link rel="stylesheet" type="text/css" href="/public/css/pygment.min.css"/>
  <link rel="stylesheet" type="text/css" href="/public/css/font.min.css"/>
  <link rel="stylesheet" type="text/css" href="/public/css/fontawesome.min.css"/>
  <link rel="stylesheet" type="text/css" href="/public/css/timeline.min.css"/>
  <!-- Icons -->
  <link rel="shortcut icon" href="/public/favicon.ico"/>
  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml"/>
  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?255eea8e4f351751c55384cb560b5a53";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>

</head>

  <body>   
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p></p>    
  </div>
  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">首页</a>
    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about.html">关于</a>
        
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/categories.html">分类</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/message.html">留言</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/posts/">文档</a>
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/tags/">标签</a>
        
      
    
      
        
      
    
  </nav>
  <div class="sidebar-item">
    <p>
      &copy; Design by <a href="http://localhost:4000" target="_blank">Reage</a>
    </p>
  </div>
</div>
    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Reage blog</a>
            <small></small>
              <a href="/atom.xml" target="_blank" class="icons" style="margin-left:15px;"><i class="fa fa-rss"></i></a>
              <a href="https://github.com/rentiansheng" target="_blank" class="icons"><i class="fa fa-github"></i></a>
          </h3>          
        </div>        
      </div>
      <div class="container content" style="margin-top:2rem">
        <div class="post">
  <h1 class="post-title">The Golang operation EXCEL  library  for columns and cell  supports data validation  (drop-down list, numeric text length check)</h1>
  <div class="post-date">
    <span><i class="fa fa-clock-o"></i> 2018-04-29</span>
  <span class="extra-right"><i class="fa fa-tags"></i> golang, excel, and data validation
</span>
  </div>
  <h3 id="completed-function">completed function</h3>

<p>   1. Cell, column support drop-down list selection</p>

<p>   2. Cell, column support range check</p>

<p>   3. Open Excel support cell, column data check read</p>

<p>  </p>
<h3 id="items-to-pay-attention-to">Items to pay attention to</h3>
<p>  
   1. Excel data validation supports setting the length of the check character to 255,</p>

<p>   2. Excel is not supported as a check condition by selecting cells in the workbook</p>

<h2 id="1-remise">1. remise</h2>
<hr />

<p>Recently used in Golang development projects used excel import, export. Data export is no problem, just write excel on the line. However, importing templates has encountered some problems.</p>

<p>Questions are as follows:</p>

<pre><code>1. The data in db is defined as a string. If the field is filled with numbers, the field is a number when the data is acquired. The backend conversion is required.
2. Enumerate the type fields, fill in too difficult. Users need to know the corresponding value
3. The field range value, fill in more difficult, (such as user, type, etc.)
3  can not limit the length of the field to fill in the content
4. Cannot limit the range of numbers
</code></pre>

<p>Why not directly put an excel file, the data in the project is imported, the export field is not fixed, you need to import according to the personal configuration real field, export</p>

<h2 id="2-golang-excel-class-library-selection">2. Golang EXCEL Class Library Selection</h2>
<hr />

<p>After the Internet search found two more use now more golang operation excel class library</p>
<ol>
  <li><a href="https://github.com/360EntSecGroup-Skylar/excelize">excelize</a></li>
  <li><a href="https://github.com/tealeg/xlsx">xlsx</a></li>
</ol>

<p>In most cases, xlsx is selected, and xlsx is more in star and fork than excelle. However, excelize is more active in recent activity and the document is more detailed (in Chinese)</p>

<h2 id="3-use-excel-data-validation">3. Use EXCEL data validation</h2>
<hr />
<p>In the use of xlsx, there is no problem with basic functions, but when doing advanced functions, it is found that many advanced functions do not have time, and some implementations are too rude. The data verification function is not implemented at all. Originally wanted to copy excelize the code, and found that they did not achieve, still lying in the todo list. Helplessness can only be implemented on xlsx itself.</p>

<p>Now it’s simple and crude to implement the list of excel data validation, rang validation (time, date need to be converted to numbers, now unimplemented) has confirmed that available data validation has list (display dorp box), rang (number, decimal, text length ), User input will be prompted for incorrect content.</p>

<p>An example of a test code for data validation is at <a href="https://github.com/rentiansheng/xlsx/blob/dev_master/datavalidation_test.go">data validation test code</a>
You can go test to view the production excel content.</p>

<h2 id="4-need-to-prepare-for-the-development-of-excel">4. Need to prepare for the development of EXCEL</h2>
<hr />

<p>Excel is a zip file described by openxml.
The files in the office are all similar. Microsoft has published the document.</p>

<p>tool:
Open xml sdk 2.0 tool, can view the openxml code of excel file, provide verification, documentation, generate code function (not golang)</p>

  <div class="post-affix">
    <a href="http://localhost:4000"> articles from reage blog -- http://localhost:4000</a>
  </div>
</div>

<div class="read-more">
  
  <div class="read-more-header">
    <a href="/golang/2018/04/29/golangexceldatavalidation.html" class="read-more-btn">Read More</a>
  </div><!-- /.read-more-header -->
  <div class="read-more-content">
    <h3><a href="http://localhost:4000/other/2023/12/22/chatglm2-6b-install.html" title="ChatGLM2-6B install">ChatGLM2-6B install</a></h3>
  </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
    <div class="list-item">
      <h4><a href="/golang/2022/12/12/go_reflect.md.html" title="reflect 使用总结">reflect 使用总结</a></h4>
      <span><i class="fa fa-clock-o"></i>  2022-12-12</span>
    </div><!-- /.list-item -->
    
    <div class="list-item">
      <h4><a href="/golang/2022/10/27/go_mapper.html" title="golang mapper 数据深拷贝">golang mapper 数据深拷贝</a></h4>
      <span><i class="fa fa-clock-o"></i>  2022-10-27</span>
    </div><!-- /.list-item -->
    
  </div><!-- /.read-more-list -->
  
</div><!-- /.read-more -->

<script>
var _hmt = _hmt || [];
(function() {
      var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?255eea8e4f351751c55384cb560b5a53";
          var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
})();
</script>

<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
        this.page.url = window.location.href;
    };
    (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://reage.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

      </div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>

  </body>
</html>
