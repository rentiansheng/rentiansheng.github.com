<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="keywords" content="Golang EXCEL column, cell data validation (drop-down list, numeric text length check)">
  <meta name="description" content="">
  <meta name="author" content="Reage">
  <title>
    
      Golang EXCEL column, cell data validation (drop-down list, numeric text length check) &middot; Reage blog
    
  </title>
  <!-- CSS -->
  <link rel="stylesheet" type="text/css" href="/public/css/poole.min.css" />
  <link rel="stylesheet" type="text/css" href="/public/css/lanyon.min.css"/>
  <link rel="stylesheet" type="text/css" href="/public/css/pygment.min.css"/>
  <link rel="stylesheet" type="text/css" href="/public/css/font.min.css"/>
  <link rel="stylesheet" type="text/css" href="/public/css/fontawesome.min.css"/>
  <link rel="stylesheet" type="text/css" href="/public/css/timeline.min.css"/>
  <!-- Icons -->
  <link rel="shortcut icon" href="/public/favicon.ico"/>
  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml"/>
  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?255eea8e4f351751c55384cb560b5a53";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>

</head>

  <body>   
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p></p>    
  </div>
  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">首页</a>
    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about.html">关于</a>
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/categories.html">分类</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/message.html">留言</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/posts/">文档</a>
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/tags/">标签</a>
        
      
    
    <a class="sidebar-nav-item" href="http://www.rhttp.cn" target="_blank">之前blog</a>
  </nav>
  <div class="sidebar-item">
    <p>
      &copy; Design by <a href="http://localhost:4000" target="_blank">Reage</a>
    </p>
  </div>
</div>
    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Reage blog</a>
            <small></small>
              <a href="/atom.xml" target="_blank" class="icons" style="margin-left:15px;"><i class="fa fa-rss"></i></a>
              <a href="https://github.com/rentiansheng" target="_blank" class="icons"><i class="fa fa-github"></i></a>
          </h3>          
        </div>        
      </div>      
      
        <ul class="entry-meta inline-list" style="text-align: center;">
          
        </ul>            
      <div class="container content" style="margin-top:2rem">
        <div class="post">
  <h1 class="post-title">Golang EXCEL column, cell data validation (drop-down list, numeric text length check)</h1>
  <div class="post-date">
    <span><i class="fa fa-clock-o"></i> 2018-04-29</span>
  <span class="extra-right"><i class="fa fa-tags"></i> golang, excel, and data validation
</span>
  </div>
  <h2 id="1-remise">1. remise</h2>
<hr />

<p>Recently used in Golang development projects used excel import, export. Data export is no problem, just write excel on the line. However, importing templates has encountered some problems.</p>

<p>Questions are as follows:
   
    1. The data in db is defined as a string. If the field is filled with numbers, the field is a number when the data is acquired. The backend conversion is required.
    2. Enumerate the type fields, fill in too difficult. Users need to know the corresponding value
    3. The field range value, fill in more difficult, (such as user, type, etc.)
    3  can not limit the length of the field to fill in the content
    4. Cannot limit the range of numbers</p>

<p>Why not directly put an excel file, the data in the project is imported, the export field is not fixed, you need to import according to the personal configuration real field, export</p>

<h2 id="2-golang-excel-class-library-selection">2. Golang EXCEL Class Library Selection</h2>
<hr />

<p>After the Internet search found two more use now more golang operation excel class library</p>
<ol>
  <li>https://github.com/360EntSecGroup-Skylar/excelize</li>
  <li>https://github.com/tealeg/xlsx</li>
</ol>

<p>In most cases, xlsx is selected, and xlsx is more in star and fork than excelle. However, excelize is more active in recent activity and the document is more detailed (in Chinese)</p>

<h2 id="3-use-excel-data-validation">3. Use EXCEL data validation</h2>
<hr />
<p>In the use of xlsx, there is no problem with basic functions, but when doing advanced functions, it is found that many advanced functions do not have time, and some implementations are too rude. The data verification function is not implemented at all. Originally wanted to copy excelize the code, and found that they did not achieve, still lying in the todo list. Helplessness can only be achieved by yourself.</p>

<p>Implement the function code in:
The https://github.com/rentiansheng/xlsx code has been submitted to the PR but has not been merged.
Now it’s simple and crude to implement the list of excel data validation, rang validation (time, date need to be converted to numbers, now unimplemented) has confirmed that available data validation has list (display dorp box), rang (number, decimal, text length ), User input will be prompted for incorrect content.</p>

<p>An example of a test code for data validation is at https://github.com/rentiansheng/xlsx/blob/dev_master/datavalidation_test.go
You can go test to view the production excel content.</p>

<h2 id="4-need-to-prepare-for-the-development-of-excel">4. Need to prepare for the development of EXCEL</h2>
<hr />

<p>Excel is a zip file described by openxml.
The files in the office are all similar. Microsoft has published the document.</p>

<p>tool:
Open xml sdk 2.0 tool, can view the openxml code of excel file, provide verification, documentation, generate code function (not golang)</p>

  <div class="post-affix">
    <a href="http://localhost:4000"> articles from reage blog -- http://localhost:4000</a>
  </div>
</div>

<div class="read-more">
  
  <div class="read-more-header">
    <a href="/golang/2018/04/29/golangexceldatavalidation.html" class="read-more-btn">Read More</a>
  </div><!-- /.read-more-header -->
  <div class="read-more-content">
    <h3><a href="http://localhost:4000/golang/2018/04/29/golangexceldatavalidation.html" title="Golang EXCEL 列，单元格数据验证(下拉列表，数字文本长度校验)">Golang EXCEL 列，单元格数据验证(下拉列表，数字文本长度校验)</a></h3>
  </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
    <div class="list-item">
      <h4><a href="/golang/2018/03/16/godownfilecontenttype.html" title="golang 下载文件格式错误">golang 下载文件格式错误</a></h4>
      <span><i class="fa fa-clock-o"></i>  2018-03-16</span>
    </div><!-- /.list-item -->
    
    <div class="list-item">
      <h4><a href="/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/2016/11/16/servicemangger.html" title="服务治理">服务治理</a></h4>
      <span><i class="fa fa-clock-o"></i>  2016-11-16</span>
    </div><!-- /.list-item -->
    
  </div><!-- /.read-more-list -->
  
</div><!-- /.read-more -->
<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="Golang EXCEL column, cell data validation (drop-down list, numeric text length check)" data-title="Golang EXCEL column, cell data validation (drop-down list, numeric text length check)" data-url="//golang/2018/04/29/golangexceldatavalidation_en.html"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
  var duoshuoQuery = {short_name:"ireage"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>
<!-- 多说公共JS代码 end -->
<!-- 百度统计代码 -->
<script>
var _hmt = _hmt || [];
(function() {
      var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?255eea8e4f351751c55384cb560b5a53";
          var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
})();
</script>


      </div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>

  </body>
</html>
